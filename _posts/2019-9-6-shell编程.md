---
layout: post
title: "shell编程"
date: 2019-9-6
excerpt: "shell"
tags: [shell]
comments: true
---



[TOC]

## 特殊shell变量

| 位置变量 |                           作用说明                           |
| :------: | :----------------------------------------------------------: |
|    $0    | 获取当前执行的shell脚本的文件名，如果包含路径，那么就包括脚本路径 |
|    $n    | 获取当前执行的shell脚本的第n个参数值，n=1...9，当n为0时表示脚本文件名； |
|    $*    |      获取当前shell脚本所有传参的参数。"$*" = "$1 $2 $3"      |
|    $@    |    获取当前shell脚本所有传参的参数。"$@" = "$1" "$2" "$3"    |
|    $?    |             获取执行上一个指令的执行状态的返回值             |
|    $$    |               获取当前执行的shell脚本的进程号                |
|    $!    |              获取上一个在后台工作的进程的进程号              |
|    $_    |          获取在此之前执行的命令或脚本的最后一个参数          |

- exec

  - 功能：exec能够不创建新的子进程的前提下，转去执行指定的命令，当指定的命令执行完毕后，该进程就终止了。

    ```shell
    exec <./tmp.log
    while read line
    do
    	echo $line
    done 
    	echo read_file_ok
    ```

    - 当使用exec打开文件后，read命令**每次**都会将文件指针移动到文件的下一行进行读取，直到文件末尾，利用这个可以实现**处理文件内容 **。

- shift

  - $2变成$1,$3变成$2

    ```shell
    if [ $# -eq 2 ];then
    	shift
    	echo $1
    fi
    ```

    

## shell变量子串

|  ID  |           表达式            |                             说明                             |
| :--: | :-------------------------: | :----------------------------------------------------------: |
|  1   |        ${parameter}         |                   返回变量$parameter的内容                   |
|  2   |        ${#parameter}        |                 返回变量$parameter内容的长度                 |
|  3   |     ${parameter:offset}     |   在变量${parameter}中，从位置offest之后开始提取子串到结尾   |
|  4   | ${parameter:offset:length}  | 在变量${parameter}中，从位置offset之后开始截取长度为length的子串 |
|  5   |      ${parameter#word}      |       从变量${parameter}开头开始删除最短匹配的word子串       |
|  6   |     ${parameter##word}      |         从变量${parameter}开头删除最长匹配的word子串         |
|  7   |      ${parameter%word}      |                 从结尾删除最短匹配的word子串                 |
|  8   |     ${parameter%%word}      |               从结尾开始删除最长匹配的word子串               |
|  9   | ${parameter/pattern/string} |              使用string代替第一个匹配的pattern               |

## shell特殊扩展变量

|       表达式       |                             说明                             |
| :----------------: | :----------------------------------------------------------: |
| ${parameter:-word} | 如果parameter的变量值为空或未赋值，则会返回word字符串并替换变量的值。 |
| ${parameter:=word} |   如果parameter的变量值为空或未赋值，则设置这个变量为word    |
| ${parameter:?word} |  如果parameter变量值为空或未赋值，那么word视为标准错误输出   |
| ${parameter:+word} | 如果parameter为空或未赋值，则什么都不做，否则word字符串替代变量值 |

